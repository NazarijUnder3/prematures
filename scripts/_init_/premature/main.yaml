databaseChangeLog:
- changeSet:
    id: create_main
    author: NP
    labels: tag
    context: dev,qa,uat,prod
    changes:
    - tagDatabase:
        tag: create_main
    comment: create main
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_schema.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_pregnancy_dictionary.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_pregnancy.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_child_dictionary.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_child.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_followup_dictionary.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_followup.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_disorder_dictionary.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_disorder.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_disability_dictionary.sql
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_disability.sql
- changeSet:
    id: 1
    author: NP
    runOnChange: true
    labels: create_function
    context: dev,qa,uat,prod
    comment: create partition management functions
    changes:
    - createProcedure:
        schemaName: main
        path: _init_/main/partition_manage.sql
    rollback: 
    - sql: 
        sql: drop function if exists main.fn_partition_add;
    - sql: 
        sql: drop function if exists main.fn_partition_create;
    - sql:
        sql: drop function if exists main.fn_partition_extend;
- changeSet:
    id: 2
    author: NP
    runOnChange: true
    labels: create_function
    context: dev,qa,uat,prod
    comment: create partition management functions
    changes:
    - createProcedure:
        schemaName: main
        path: _init_/main/main_manage.sql
    rollback: 
    - sql: 
        sql: drop function if exists main.fn_track_change
    - sql: 
        sql: drop function if exists main.fn_main_table_set(regclass, boolean, boolean, text[])
    - sql: 
        sql: drop procedure if exists main.fn_main_table_drop
    - sql: 
        sql: drop function if exists main.fn_main_table_set(regclass, boolean, boolean)
    - sql: 
        sql: drop function if exists main.fn_main_table_set(regclass)
    - sql: 
        sql: drop function if exists main.fn_main_schema_set
    - sql: 
        sql: drop procedure if exists main.fn_main_schema_drop
    - sql: 
        sql: drop procedure if exists main.fn_main_schema_disable;
    - sql:
        sql: drop procedure if exists main.fn_main_schema_enable;
    - sql:
        sql: drop procedure if exists main.fn_main_schema;
    - sql:
        sql: drop function if exists main.fn_track_table_list_set;
    - sql:
        sql: drop function if exists main.fn_track_table_list_drop;
    - sql:
        sql: drop function if exists main.fn_track_table_list_fill;
- changeSet:
    id: 5
    author: NP
    runOnChange: true
    labels: create_function
    context: dev,qa,uat,prod
    comment: create functions to list tracked tables
    changes:
    - createProcedure:
        schemaName: main
        path: _init_/main/main_stats.sql
    rollback: 
    - sql: 
        sql: drop function if exists main.fn_tracked_table_name
    - sql: 
        sql: drop function if exists main.fn_non_tracked_table_name
- include:
    author: NP
    runOnChange: false
    file: _init_/main/create_views_queue.sql
